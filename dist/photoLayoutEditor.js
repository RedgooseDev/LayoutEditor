!function(e){function t(r){if(n[r])return n[r].exports;var o=n[r]={i:r,l:!1,exports:{}};return e[r].call(o.exports,o,o.exports,t),o.l=!0,o.exports}var n={};t.m=e,t.c=n,t.i=function(e){return e},t.d=function(e,n,r){t.o(e,n)||Object.defineProperty(e,n,{configurable:!1,enumerable:!0,get:r})},t.n=function(e){var n=e&&e.__esModule?function(){return e.default}:function(){return e};return t.d(n,"a",n),n},t.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},t.p="",t(t.s=32)}([function(e,t){e.exports=React},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.INIT_PLE="INIT_PLE",t.SIDE_VISIBLE="SIDE_VISIBLE",t.ADD_FILES="ADD_FILES",t.REMOVE_FILES="REMOVE_FILES",t.CHANGE_ACTIVE_FILE="CHANGE_ACTIVE_FILE",t.SIDE_TOGGLE="SIDE_TOGGLE",t.ATTACH_IMAGES="ATTACH_IMAGES",t.REMOVE_IMAGES="REMOVE_IMAGES",t.GRID_ADD_BLOCK="GRID_ADD_BLOCK",t.GRID_REMOVE_BLOCK="GRID_REMOVE_BLOCK",t.GRID_SHUFFLE_BLOCKS="GRID_SHUFFLE_BLOCKS",t.GRID_DUPLICATE_BLOCK="GRID_DUPLICATE_BLOCK",t.GRID_UPDATE_BLOCKS="GRID_UPDATE_BLOCKS",t.GRID_ACTIVE_BLOCK="GRID_ACTIVE_BLOCK",t.GRID_SETTING_UPDATE="GRID_SETTING_UPDATE",t.GRID_CHANGE_COLOR="GRID_CHANGE_COLOR",t.CROPPER_OPEN="CROPPER_OPEN",t.CROPPER_CLOSE="CROPPER_CLOSE"},function(e,t){e.exports=ReactRedux},function(e,t){e.exports=Redux},function(e,t,n){"use strict";function r(e){return{type:y.GRID_ADD_BLOCK,value:e}}function o(e){return{type:y.GRID_REMOVE_BLOCK,index:e}}function i(e){return{type:y.GRID_SHUFFLE_BLOCKS,value:e}}function a(e){return{type:y.GRID_DUPLICATE_BLOCK,index:e}}function l(e){return{type:y.GRID_UPDATE_BLOCKS,value:e}}function u(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return{type:y.GRID_ACTIVE_BLOCK,value:e,isImage:t}}function c(e,t){return{type:y.GRID_CHANGE_COLOR,item:e,color:t}}function s(e){return{type:y.GRID_SETTING_UPDATE,value:e}}function f(e,t){return{type:y.ATTACH_IMAGES,value:e,columns:t}}function d(e){return{type:y.REMOVE_IMAGES,value:e}}Object.defineProperty(t,"__esModule",{value:!0}),t.addBlock=r,t.removeBlock=o,t.shuffleBlocks=i,t.duplicateBlock=a,t.updateBlocks=l,t.activeBlock=u,t.changeColorBlock=c,t.updateSetting=s,t.attachImages=f,t.removeImages=d;var p=n(1),y=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(p)},function(e,t,n){"use strict";function r(e){return{type:u.SIDE_VISIBLE,value:e}}function o(){return{type:u.SIDE_TOGGLE}}function i(e){return{type:u.ADD_FILES,files:e}}function a(e){return{type:u.REMOVE_FILES,ids:e}}function l(e,t,n){return{type:u.CHANGE_ACTIVE_FILE,num:e,keyName:t,firstNum:n}}Object.defineProperty(t,"__esModule",{value:!0}),t.visible=r,t.toggle=o,t.addFiles=i,t.removeFiles=a,t.changeActiveFile=l;var u=n(1)},function(e,t,n){"use strict";function r(e){for(var t=e.length-1;t>=0;t--){var n=Math.floor(Math.random()*(t+1)),r=e[n];e[n]=e[t],e[t]=r}return e}function o(){for(var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"index",n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,r=0;r<e.length;r++)if(e[r][t]===n)return r}Object.defineProperty(t,"__esModule",{value:!0}),t.shuffle=r,t.findObjectValueInArray=o},function(e,t,n){"use strict";function r(){return"ontouchstart"in window||navigator.MaxTouchPoints>0||navigator.msMaxTouchPoints>0}function o(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"pleTimer";return new Promise(function(n){window[t]=setTimeout(n,e)})}Object.defineProperty(t,"__esModule",{value:!0}),t.isTouchDevice=r,t.sleep=o},function(e,t,n){"use strict";function r(e){return{type:a.CROPPER_OPEN,value:e}}function o(e){return{type:a.CROPPER_CLOSE,value:e}}Object.defineProperty(t,"__esModule",{value:!0}),t.open=r,t.close=o;var i=n(1),a=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(i)},function(e,t){e.exports=$},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function o(e){this.layout=new a.default(e),this.side=new u.default(e)}Object.defineProperty(t,"__esModule",{value:!0});var i=n(17),a=r(i),l=n(18),u=r(l);t.default=o},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var l=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),u=n(0),c=r(u),s=n(2),f=n(31),d=n(23),p=r(d),y=n(30),b=r(y),h=n(25),m=r(h),v=function(e){function t(){return o(this,t),i(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return a(t,e),l(t,[{key:"componentDidMount",value:function(){var e=this.props,t=e.PLE;(0,e.dispatch)((0,f.initPLE)(t))}},{key:"visibleSide",value:function(){var e=this.props,t=e.tree,n=e.ple;n&&(t.side.layout.visible?n.el.classList.add("side-active"):n.el.classList.remove("side-active"))}},{key:"render",value:function(){var e=this.props,t=e.ple,n=e.tree;return t?(this.visibleSide(),c.default.createElement("div",{className:"ple-wrap"},c.default.createElement(p.default,null),c.default.createElement(b.default,null),n.cropper.visible&&c.default.createElement(m.default,null))):null}}]),t}(c.default.Component);t.default=(0,s.connect)(function(e){return Object.assign({},e,{})})(v)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(9),o=function(e){return e&&e.__esModule?e:{default:e}}(r),i=(0,o.default)(window);t.default={names:{17:"ctrl",91:"cmd",93:"cmd",16:"shift"},code:null,keyName:null,apply:function(e){this.code=e,this.keyName=this.names[this.code]||null},keyDown:function(e){this.apply(e.keyCode),i.on("keyup.PLE",this.keyUp.bind(this)),i.off("keydown.PLE")},keyUp:function(e){this.code===e.keyCode&&(this.apply(null),i.on("keydown.PLE",this.keyDown.bind(this)),i.off("keyup.PLE"))},init:function(){i.on("keydown.PLE",this.keyDown.bind(this))}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e};t.default=function(e,t){return{body:r({},e&&e.body,t&&t.body,{setting:r({},e&&e.body&&e.body.setting,t&&t.body&&t.body.setting)}),side:r({},e&&e.side,t&&t.side)}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default={body:{setting:{width:100,height:100,column:5,outerMargin:10,innerMargin:10,freeMode:!1},blockColor:"#dddddd",grid:[{layout:{x:0,y:0,w:2,h:2}},{layout:{x:2,y:0,w:1,h:2}},{layout:{x:3,y:0,w:2,h:1}},{layout:{x:3,y:1,w:1,h:1}}]},side:{upload:null,remove:null,visible:!0,items:[]}}},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var o=n(3),i=n(38),a=r(i),l=n(36),u=r(l),c=n(39),s=r(c),f=n(37),d=r(f);t.default=(0,o.combineReducers)({tree:(0,o.combineReducers)({side:s.default,body:u.default,cropper:d.default}),ple:a.default})},function(e,t){e.exports=ReactDOM},function(e,t,n){"use strict";function r(e){this.toggleSide=function(t){var n=e.store,r=n.getState,i=n.dispatch;if(!r()||!r().tree)return void alert("error");var a=r().tree.side.layout.visible,l=void 0===t?!a:t;i((0,o.visible)(l))}}Object.defineProperty(t,"__esModule",{value:!0}),t.default=r;var o=n(5)},function(e,t,n){"use strict";function r(e){e.store.dispatch;this.addItems=function(e){console.log(e)}}Object.defineProperty(t,"__esModule",{value:!0}),t.default=r;n(5)},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var l,u,c=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},s=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),f=n(0),d=r(f),p=n(2),y=n(41),b=r(y),h=n(4),m=(n(6),[]),v=(u=l=function(e){function t(){return o(this,t),i(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return a(t,e),s(t,[{key:"_selectBlock",value:function(e,t){this.props.dispatch((0,h.activeBlock)(e,t))}},{key:"_updateBlocks",value:function(e,t){var n=this.props;switch(e){case"start":m[0]=(new Date).getTime();break;case"end":if(m[1]=(new Date).getTime(),m[1]-m[0]>400){var r=n.tree.body.grid.map(function(e,n){return c({},e,{layout:{x:t[n].x,y:t[n].y,w:t[n].w,h:t[n].h}})});n.dispatch((0,h.updateBlocks)(r))}m=[]}}},{key:"render",value:function(){var e=this,t=this.props,n=t.tree.body,r=n.grid,o=n.setting,i=n.activeBlock,a=o.width*o.column+o.innerMargin*(o.column-1)+2*o.outerMargin;return d.default.createElement("div",{className:"ple-grid__wrap",onClick:function(){return e._selectBlock(null)}},d.default.createElement(b.default,{autoSize:!0,cols:o.column,rowHeight:o.height,width:a,margin:[o.innerMargin,o.innerMargin],containerPadding:[o.outerMargin,o.outerMargin],verticalCompact:!o.freeMode,onDragStart:function(){return e._updateBlocks("start")},onDragStop:function(t){return e._updateBlocks("end",t)},onResizeStart:function(){return e._updateBlocks("start")},onResizeStop:function(t){return e._updateBlocks("end",t)},style:{width:a+"px"},className:"ple-grid"},r.map(function(n,r){var o=n.indexPrefix+"__"+n.index;return d.default.createElement("div",{key:o,"data-grid":n.layout,onClick:function(t){t.stopPropagation(),e._selectBlock(n.index,!!n.image)},className:i===n.index&&"active",style:{backgroundColor:n.color||t.ple.preference.body.blockColor}},n.image&&d.default.createElement("figure",{style:{backgroundImage:"url('"+n.image.src+"')",backgroundPosition:n.image.position,backgroundSize:n.image.size}}))})))}}]),t}(d.default.Component),l.defaultProps={tree:null,ple:null,dispatch:null},u);t.default=(0,p.connect)(function(e){return Object.assign({},e,{})})(v)},function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function i(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),l=n(0),u=function(e){return e&&e.__esModule?e:{default:e}}(l),c=function(e){function t(){return r(this,t),o(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return i(t,e),a(t,[{key:"render",value:function(){var e=this.props,t=e.children,n=e.title,r=e.iconClass,o=e.className,i=e.onClick;return u.default.createElement("div",{className:"block "+(o||"")},u.default.createElement("button",{type:"button",title:n,onClick:i},u.default.createElement("i",{className:"sp-ico abs "+r},n)),t&&u.default.createElement("div",{className:"pop"},t))}}]),t}(u.default.Component);t.default=c},function(e,t,n){"use strict";function r(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var l,u,c=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},s=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),f=n(0),d=function(e){return e&&e.__esModule?e:{default:e}}(f),p=(u=l=function(e){function t(e){o(this,t);var n=i(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.state=c({},e.defaultSetting,e.setting),n}return a(t,e),s(t,[{key:"componentWillReceiveProps",value:function(){this.setState(c({},this.props.defaultSetting,this.props.setting))}},{key:"_reset",value:function(){this.setState(c({},this.props.defaultSetting))}},{key:"_change",value:function(e){this.setState(r({},e.target.name,parseInt(e.target.value)))}},{key:"render",value:function(){var e=this,t=this.state,n=this.props;return d.default.createElement("form",{onSubmit:function(e){n.submit(t),e.preventDefault()}},d.default.createElement("fieldset",null,d.default.createElement("legend",null,"Settings form"),d.default.createElement("h1",null,"Settings"),d.default.createElement("dl",null,d.default.createElement("dt",null,d.default.createElement("label",{htmlFor:"frm_width"},"Width")),d.default.createElement("dd",{className:"type-input"},d.default.createElement("input",{type:"number",name:"width",id:"frm_width",min:1,max:999,maxLength:3,value:this.state.width,onChange:this._change.bind(this),required:!0}),d.default.createElement("span",null,"px"))),d.default.createElement("dl",null,d.default.createElement("dt",null,d.default.createElement("label",{htmlFor:"frm_height"},"Height")),d.default.createElement("dd",{className:"type-input"},d.default.createElement("input",{type:"number",name:"height",id:"frm_height",min:1,max:999,value:this.state.height,onChange:this._change.bind(this),required:!0}),d.default.createElement("span",null,"px"))),d.default.createElement("dl",null,d.default.createElement("dt",null,d.default.createElement("label",{htmlFor:"frm_column"},"Column")),d.default.createElement("dd",{className:"type-input"},d.default.createElement("input",{type:"number",name:"column",id:"frm_column",min:1,max:99,value:this.state.column,onChange:this._change.bind(this),required:!0}),d.default.createElement("span",null,"ea"))),d.default.createElement("dl",{className:"type-input"},d.default.createElement("dt",null,d.default.createElement("label",{htmlFor:"frm_outerMargin"},"Outer margin")),d.default.createElement("dd",null,d.default.createElement("input",{type:"number",name:"outerMargin",id:"frm_outerMargin",min:0,max:500,value:this.state.outerMargin,onChange:this._change.bind(this),required:!0}),d.default.createElement("span",null,"px"))),d.default.createElement("dl",{className:"type-input"},d.default.createElement("dt",null,d.default.createElement("label",{htmlFor:"frm_innerMargin"},"Inner margin")),d.default.createElement("dd",null,d.default.createElement("input",{type:"number",name:"innerMargin",id:"frm_innerMargin",min:0,max:500,value:this.state.innerMargin,onChange:this._change.bind(this),required:!0}),d.default.createElement("span",null,"px"))),d.default.createElement("dl",null,d.default.createElement("dt",null,d.default.createElement("label",{htmlFor:"frm_freeMode"},"Free mode")),d.default.createElement("dd",{className:"type-checkbox"},d.default.createElement("label",null,d.default.createElement("input",{type:"radio",name:"freeMode",id:"frm_freeMode",onChange:function(){return e.setState({freeMode:!0})},checked:this.state.freeMode}),d.default.createElement("span",null,"true")),d.default.createElement("label",null,d.default.createElement("input",{type:"radio",name:"freeMode",onChange:function(){return e.setState({freeMode:!1})},checked:!this.state.freeMode}),d.default.createElement("span",null,"false"))))),d.default.createElement("nav",null,d.default.createElement("span",null,d.default.createElement("button",{type:"button",onClick:this._reset.bind(this)},"Reset")),d.default.createElement("span",null,d.default.createElement("button",{type:"submit",className:"submit"},"Apply"))))}}]),t}(d.default.Component),l.defaultProps={submit:function(){},setting:null,defaultSetting:{width:100,height:100,column:5,outerMargin:10,innerMargin:10,freeMode:!1}},u);t.default=p},function(e,t,n){"use strict";function r(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}function o(e){return e&&e.__esModule?e:{default:e}}function i(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function l(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function u(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var c,s,f=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},d=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),p=n(0),y=o(p),b=n(2),h=n(40),m=o(h),v=n(33),g=n(6),_=n(4),E=r(_),O=n(8),w=r(O),P=n(20),k=o(P),j=n(21),C=o(j),I=(s=c=function(e){function t(e){a(this,t);var n=l(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.state={active:{setting:!1,editBlockColor:!1}},n}return u(t,e),d(t,[{key:"changeActive",value:function(e,t,n){var r=this,o=this.state,a=t||!o.active[e],l=n?n.currentTarget:null;a?$(document).on("click.pleToolbar",function(t){$(t.target).closest(".pop").length||t.target!==l&&t.target.parentNode!==l&&r.changeActive(e,!1)}):$(document).off("click.pleToolbar"),this.setState({active:f({},o.active,i({setting:!1,editColor:!1},e,a))})}},{key:"deactivate",value:function(){var e=this;return $(document).off("click.pleToolbar"),new Promise(function(t){e.setState({active:{setting:!1,editColor:!1}},t)})}},{key:"submitEditSetting",value:function(e){return this.props.dispatch(E.updateSetting(e)),this.changeActive("setting",!1),!1}},{key:"_onClickEdit",value:function(){var e=this.props,t=(0,g.findObjectValueInArray)(e.tree.body.grid,"index",e.tree.body.activeBlock),n=e.tree.body.grid[t];n.image&&e.dispatch(w.open({image:n.image.src,color:n.color,imageResize:"cover"!==n.image.size,position:n.image.position,size:{width:e.tree.body.setting.width*n.layout.w,height:e.tree.body.setting.height*n.layout.h}}))}},{key:"render",value:function(){var e=this,t=this.state,n=this.props,r=n.ple,o=n.dispatch,i=n.tree,a=i.body.setting,l=i.body.visibleToolbarButtons,u="#ffffff";if(i.body.grid&&i.body.grid.length&&null!==i.body.activeBlock){var c=(0,g.findObjectValueInArray)(i.body.grid,"index",i.body.activeBlock);u=i.body.grid[c]&&i.body.grid[c].color?i.body.grid[c].color:r.preference.body.blockColor}return y.default.createElement("nav",{className:"ple-toolbar"},y.default.createElement("div",{className:"wrap"},l.setting&&y.default.createElement(k.default,{iconClass:"ico-setting",className:"edit-setting "+(t.active.setting?"active":""),onClick:function(n){n.persist(),t.active.setting||e.deactivate().then(function(){return e.changeActive("setting",null,n)})},title:"Edit preference"},y.default.createElement(C.default,{submit:this.submitEditSetting.bind(this),setting:a,defaultSetting:r.preference.body.setting})),l.shuffle&&y.default.createElement(k.default,{iconClass:"ico-arrow-random",onClick:function(){return o(E.shuffleBlocks({x:i.body.setting.column,y:2,w:2,h:2}))},title:"Shuffle block"}),l.add&&y.default.createElement(k.default,{iconClass:"ico-plus",onClick:function(){return o(E.addBlock({layout:{x:n.tree.body.grid.length%i.body.setting.column,y:1/0,w:1,h:1}}))},title:"Add block"}),l.edit&&y.default.createElement(k.default,{iconClass:"ico-pencel",className:"key",onClick:this._onClickEdit.bind(this),title:"Edit block"}),l.removeImage&&y.default.createElement(k.default,{iconClass:"ico-empty",className:"key",onClick:function(){return o(E.removeImages([i.body.activeBlock]))},title:"Remove image in block"}),l.duplicate&&y.default.createElement(k.default,{iconClass:"ico-duplicate",className:"key",onClick:function(){if(null===i.body.activeBlock)return void alert("Not found select block");o(E.duplicateBlock(i.body.activeBlock))},title:"Duplicate block"}),l.removeBlock&&y.default.createElement(k.default,{iconClass:"ico-trash",className:"key",onClick:function(){if(null===i.body.activeBlock)return void alert("Not found select block");o(E.removeBlock([i.body.activeBlock]))},title:"Remove block"}),l.editColor&&y.default.createElement(k.default,{iconClass:"ico-palette",className:"edit-color key "+(t.active.editColor?"active":""),onClick:function(t){t.persist(),e.deactivate().then(function(){return e.changeActive("editColor",null,t)})},title:"Change color"},y.default.createElement(m.default,{onChange:function(e){(e=(0,v.rgbToHex)(e))&&o(E.changeColorBlock(i.body.activeBlock,e))},color:u}))))}}]),t}(y.default.Component),c.defaultProps={ple:null,dispatch:null,tree:null},s);t.default=(0,b.connect)(function(e){return Object.assign({},e,{})})(I)},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var l=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),u=n(0),c=r(u),s=n(19),f=r(s),d=n(22),p=r(d),y=function(e){function t(e){return o(this,t),i(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e))}return a(t,e),l(t,[{key:"render",value:function(){return c.default.createElement("div",{className:"ple-container"},c.default.createElement("div",{className:"ple-body"},c.default.createElement(p.default,null),c.default.createElement(f.default,null)))}}]),t}(c.default.Component);t.default=y},function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function i(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),l=n(0),u=function(e){return e&&e.__esModule?e:{default:e}}(l),c=function(e){function t(){return r(this,t),o(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return i(t,e),a(t,[{key:"render",value:function(){return u.default.createElement("figure",{className:"ple-cropper__figure"},"item")}}]),t}(u.default.Component);t.default=c},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var l=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),u=n(0),c=r(u),s=n(2),f=n(8),d=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(f),p=n(24),y=r(p),b=function(e){function t(){return o(this,t),i(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return a(t,e),l(t,[{key:"_onClose",value:function(){this.props.dispatch(d.close())}},{key:"render",value:function(){this.state,this.props;return c.default.createElement("div",{className:"ple-cropper"},c.default.createElement("span",{className:"ple-cropper__bg"}),c.default.createElement("div",{className:"ple-cropper__wrap"},c.default.createElement(y.default,null),c.default.createElement("nav",{className:"ple-cropper__nav"},c.default.createElement("button",{type:"button",onClick:this._onClose.bind(this)},c.default.createElement("i",{className:"sp-ico ico-close abs"},"Close cropper")),c.default.createElement("button",{type:"button",onClick:function(){}},c.default.createElement("i",{className:"sp-ico ico-resize abs"},"Toggle background size type")),c.default.createElement("button",{type:"button",onClick:function(){}},c.default.createElement("i",{className:"sp-ico ico-reduction abs"},"Go to center image")))),"aaa")}}]),t}(c.default.Component);t.default=(0,s.connect)(function(e){return Object.assign({},e,{})})(b)},function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function i(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var a,l,u=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),c=n(0),s=function(e){return e&&e.__esModule?e:{default:e}}(c),f=(l=a=function(e){function t(){return r(this,t),o(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return i(t,e),u(t,[{key:"render",value:function(){var e=this.props,t=e.image,n=e.onClick,r=e.active;return s.default.createElement("li",null,s.default.createElement("button",{type:"button","data-image":t,style:{backgroundImage:"url('"+t+"')"},className:r?"active":"",onClick:n}))}}]),t}(s.default.Component),a.defaultProps={image:null,onClick:function(){},active:null},l);t.default=f},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var l,u,c=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),s=n(0),f=r(s),d=n(26),p=r(d),y=(u=l=function(e){function t(){return o(this,t),i(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return a(t,e),c(t,[{key:"render",value:function(){var e=this.props,t=e.files,n=e.select,r=e.progress;return f.default.createElement("div",{className:"items"},f.default.createElement("div",{className:"wrap"},f.default.createElement("ul",null,t.map(function(e,t){return f.default.createElement(p.default,{key:e.id,image:e.image,active:e.active,onClick:function(){return n(e.id)}})}),null!==r&&f.default.createElement("li",{className:"loading"},f.default.createElement("div",{className:"progress"},f.default.createElement("span",{className:"bar",style:{height:r+"%"}}),f.default.createElement("span",{className:"percent"},r+"%"))))))}}]),t}(f.default.Component),l.defaultProps={files:[],select:function(){},progress:null},u);t.default=y},function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function i(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var a,l,u=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),c=n(0),s=function(e){return e&&e.__esModule?e:{default:e}}(c),f=(l=a=function(e){function t(e){r(this,t);var n=o(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.state={timestamp:Date.now()},n}return i(t,e),u(t,[{key:"upload",value:function(e){this.props.onUpload(e.target.files),this.setState({timestamp:Date.now()})}},{key:"render",value:function(){var e=this.props,t=this.state;return s.default.createElement("nav",{className:"navigation"},s.default.createElement("div",{className:"wrap"},s.default.createElement("button",{type:"button",title:"attach images",onClick:e.onAttach},s.default.createElement("i",{className:"sp-ico ico-reply abs"},"Moving the image to grid block")),s.default.createElement("button",{type:"button",title:"toggle select",onClick:e.onToggleSelect},s.default.createElement("i",{className:"sp-ico ico-select abs"},"Toggle all select")),s.default.createElement("span",{title:"upload images",key:t.timestamp},s.default.createElement("input",{type:"file",ref:"inputFile",onChange:this.upload.bind(this),multiple:!0}),s.default.createElement("i",{className:"sp-ico ico-upload abs"},"upload images")),s.default.createElement("button",{type:"button",title:"remove images",onClick:e.onRemove},s.default.createElement("i",{className:"sp-ico ico-trash abs"},"remove images"))))}}]),t}(s.default.Component),a.defaultProps={onRemove:function(){},onToggleSelect:function(){},onAttach:function(){},onUpload:function(){}},l);t.default=f},function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function i(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),l=n(0),u=function(e){return e&&e.__esModule?e:{default:e}}(l),c=function(e){function t(){return r(this,t),o(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return i(t,e),a(t,[{key:"render",value:function(){var e=this.props,t=e.show,n=e.onClick;return u.default.createElement("button",{type:"button",onClick:n,className:"toggle"},u.default.createElement("span",null,u.default.createElement("i",{className:"sp-ico abs"+(t?" ico-arrow-right":" ico-arrow-left")},"Toggle sidebar")))}}]),t}(l.Component);t.default=c},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var l,u,c=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),s=n(0),f=r(s),d=n(2),p=n(42),y=r(p),b=n(5),h=n(4),m=n(35),v=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(m),g=n(29),_=r(g),E=n(28),O=r(E),w=n(27),P=r(w),k=null,j=(u=l=function(e){function t(e){o(this,t);var n=i(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.state={uploading:!1,itemProgress:null},n}return a(t,e),c(t,[{key:"componentDidMount",value:function(){var e=this.props.ple;this.getItems(e.preference.side.items)}},{key:"getItems",value:function(e){var t=this.props.dispatch;"string"==typeof e?y.default.get(e).then(function(e){return t((0,b.addFiles)(e.data))}).catch(function(e){return console.log("ERROR",e)}):e instanceof Array&&t((0,b.addFiles)(e))}},{key:"_selectItem",value:function(e){var t=this.props,n=t.dispatch,r=t.ple,o=t.tree,i=r.keyboard.keyName;if("shift"!==i){var a=null;o.side.files.forEach(function(t){if(t.id===e)return a=t,!1}),k=!0===a.active?null:e}n((0,b.changeActiveFile)(e,i,k))}},{key:"_removeItems",value:function(){var e=this.props,t=e.tree,n=e.dispatch,r=[];t.side.files.length&&(t.side.files.forEach(function(e){e.active&&r.push(e.id)}),r.length||confirm("모두 지울까요?")&&t.side.files.forEach(function(e){r.push(e.id)}),n((0,b.removeFiles)(r)))}},{key:"_toggleSelect",value:function(){var e=this.props,t=e.tree,n=e.dispatch,r=!1;t.side.files.some(function(e){return e.active&&(r=!0),e.active}),n(r?(0,b.changeActiveFile)(null,"none",null):(0,b.changeActiveFile)(null,"all",null))}},{key:"_upload",value:function(e){var t=this;if(!this.state.uploading){var n=this.props,r=n.ple,o=n.dispatch;this.setState({uploading:!0},function(){v.multiple(e,r.preference.side.upload).done(function(){console.log("upload complete"),t.uploading=!1,t.setState({uploading:!1})}).progress(function(e,n){switch(e){case"start":t.setState({itemProgress:0});break;case"progress":var r=parseInt(n.loaded/n.total*100);t.setState({itemProgress:r});break;case"done":t.setState({itemProgress:null}),n.src&&o((0,b.addFiles)([n.src]))}}).fail(function(){console.log("upload fail"),t.setState({uploading:!1})})})}}},{key:"_attach",value:function(){var e=this.props,t=[];if(e.tree.side.files.forEach(function(e,n){e.active&&t.push(e.image)}),!t.length)return void alert("not select image");e.dispatch((0,h.attachImages)(t,e.tree.body.setting.column))}},{key:"render",value:function(){var e=this.props,t=e.tree,n=e.dispatch;return f.default.createElement("aside",{className:"ple-side"},f.default.createElement("div",{className:"wrap "+(t.side.layout.visible?"show":"")},f.default.createElement("span",{onClick:function(){return n((0,b.changeActiveFile)(null,"none",null))},className:"background"}),f.default.createElement(_.default,{show:t.side.layout.visible,onClick:function(){return n((0,b.toggle)())}}),f.default.createElement(O.default,{onAttach:this._attach.bind(this),onToggleSelect:this._toggleSelect.bind(this),onUpload:this._upload.bind(this),onRemove:this._removeItems.bind(this)}),f.default.createElement(P.default,{files:t.side.files,select:this._selectItem.bind(this),progress:this.state.itemProgress})))}}]),t}(f.default.Component),l.defaultProps={tree:{},ple:null,dispatch:null},u);t.default=(0,d.connect)(function(e){return Object.assign({},e,{})})(j)},function(e,t,n){"use strict";function r(e){return{type:o.INIT_PLE,value:e}}Object.defineProperty(t,"__esModule",{value:!0}),t.initPLE=r;var o=n(1)},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}var o=n(0),i=r(o),a=n(16),l=n(3),u=n(2),c=n(10),s=r(c),f=n(13),d=r(f),p=n(14),y=r(p),b=n(7),h=n(12),m=r(h),v=n(15),g=r(v),_=n(11),E=r(_);window.PLE=function(e,t){this.preference=(0,d.default)(y.default,t),this.el=e,this.store=(0,l.createStore)(g.default),this.keyboard=m.default,this.keyboard.init(),(0,b.isTouchDevice)()&&document.querySelector("html").classList.add("ple-touch"),this.api=new s.default(this),(0,a.render)(i.default.createElement(u.Provider,{store:this.store},i.default.createElement(E.default,{PLE:this})),e)}},function(e,t,n){"use strict";function r(e){return e=e.match(/^rgba?[\s+]?\([\s+]?(\d+)[\s+]?,[\s+]?(\d+)[\s+]?,[\s+]?(\d+)[\s+]?/i),e&&4===e.length?"#"+("0"+parseInt(e[1],10).toString(16)).slice(-2)+("0"+parseInt(e[2],10).toString(16)).slice(-2)+("0"+parseInt(e[3],10).toString(16)).slice(-2):""}Object.defineProperty(t,"__esModule",{value:!0}),t.rgbToHex=r},function(e,t,n){"use strict";function r(e,t){return arguments.length>2&&void 0!==arguments[2]&&arguments[2]?Math.random()*(t-e)+e:Math.floor(Math.random()*(t-e+1))+e}Object.defineProperty(t,"__esModule",{value:!0}),t.randomRange=r},function(e,t,n){"use strict";function r(e){var t=u.default.Deferred(),n=new FileReader;return n.addEventListener("load",function(e){t.resolve(e.target.result)}),n.addEventListener("error",function(e){t.reject(e.target)}),n.readAsDataURL(e),t.promise()}function o(e,t){function n(e){try{var t=JSON.parse(e.target.responseText);if("success"!==t.state)throw"server error";o.resolve(t.data)}catch(e){o.reject()}}function r(e){var t=e.loaded,n=e.total;o.notify("progress",t,n)}var o=u.default.Deferred(),i=new XMLHttpRequest;if("function"!=typeof FormData&&"object"!==("undefined"==typeof FormData?"undefined":a(FormData)))return o.reject("not support browser",t),null;var l=new FormData;return l.append("files[]",t),i.open("post",e,!0),i.addEventListener("load",n),i.upload.addEventListener("progress",r),i.send(l),o.notify("start"),o.promise()}function i(e,t){function n(){if(l>=a)return void i.resolve();t?o(t,e[l]).done(function(e){i.notify("done",{count:l,src:e}),l++,n()}).progress(function(e,t,n){i.notify(e,"progress"===e&&{loaded:t,total:n})}).fail(function(e){i.reject(e)}):r(e[l]).done(function(e){i.notify("done",{count:l,src:e}),l++,n()}).fail(function(){})}var i=u.default.Deferred(),a=e.length,l=0;return n(0),i.promise()}Object.defineProperty(t,"__esModule",{value:!0});var a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};t.multiple=i;var l=n(9),u=function(e){return e&&e.__esModule?e:{default:e}}(l),c=n(7);!function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);t.default=e}(c)},function(e,t,n){"use strict";function r(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:p.setting,t=arguments[1];switch(t.type){case s.INIT_PLE:return l({},e,t.value.preference.body.setting);case s.GRID_SETTING_UPDATE:return l({},e,t.value)}return e}function o(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:p.visibleToolbarButtons,t=arguments[1];switch(t.type){case s.GRID_ACTIVE_BLOCK:return null!==t.value?Object.assign({},e,{duplicate:!0,removeBlock:!0,editColor:!0},t.isImage?{edit:!0,removeImage:!0}:{edit:!1,removeImage:!1}):l({},e,{edit:!1,removeImage:!1,duplicate:!1,removeBlock:!1,editColor:!1});case s.GRID_REMOVE_BLOCK:return l({},e,{edit:!1,removeImage:!1,duplicate:!1,removeBlock:!1,editColor:!1})}return e}function i(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments[1],n=null,r=null;switch(t.type){case s.INIT_PLE:return(t.value.preference.body.grid||e).map(function(e,t){return y=null===y?0:y+1,l({color:null},e,{index:y,indexPrefix:b})});case s.GRID_ADD_BLOCK:return y=null===y?0:y+1,e.concat(l({color:null,layout:{x:1/0,y:1/0,w:1,h:1}},t.value,{index:y,indexPrefix:b}));case s.GRID_REMOVE_BLOCK:if(!t.index||!t.index.length)return e;n=Object.assign([],e);for(var o=0;o<t.index.length;o++){var i=(0,d.findObjectValueInArray)(n,"index",t.index[o]);n.splice(i,1)}return n;case s.GRID_SHUFFLE_BLOCKS:return b++,n=Object.assign([],e),n.map(function(e,n){return l({},e,{layout:{x:(0,f.randomRange)(0,t.value.x-1),y:(0,f.randomRange)(0,t.value.y-1),w:(0,f.randomRange)(1,t.value.w),h:(0,f.randomRange)(1,t.value.h)},indexPrefix:b})});case s.GRID_DUPLICATE_BLOCK:return r=(0,d.findObjectValueInArray)(e,"index",t.index),e[r]?(y=null===y?0:y+1,e.concat(l({},e[r],{index:y}))):e;case s.GRID_CHANGE_COLOR:return n=Object.assign([],e),r=(0,d.findObjectValueInArray)(n,"index",t.item),n[r]&&(n[r].color=t.color),n;case s.ATTACH_IMAGES:return t.value&&t.value.length?(n=Object.assign([],e),n.forEach(function(e){e.image||t.value&&t.value.length&&(e.image={src:t.value.splice(0,1),position:"50% 50%",size:"cover"})}),t.value.length&&t.value.forEach(function(r,o){y=null===y?0:y+1,n=n.concat({color:null,layout:{x:(e.length+o)%t.columns,y:1/0,w:1,h:1},image:{src:r,position:"50% 50%",size:"cover"},index:y})}),n):e;case s.REMOVE_IMAGES:return n=Object.assign([],e),t.value.forEach(function(e){r=(0,d.findObjectValueInArray)(n,"index",e),n[r]&&n[r].image&&delete n[r].image}),n;case s.GRID_UPDATE_BLOCKS:return Object.assign([],e,t.value);case s.CROPPER_CLOSE:return e}return e}function a(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=arguments[1];switch(t.type){case s.GRID_ACTIVE_BLOCK:return t.value;case s.GRID_REMOVE_BLOCK:return null}return e}Object.defineProperty(t,"__esModule",{value:!0});var l=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},u=n(3),c=n(1),s=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(c),f=n(34),d=n(6),p={setting:{width:100,height:100,maxColumn:5,outerMargin:10,innerMargin:10},visibleToolbarButtons:{setting:!0,shuffle:!0,add:!0,edit:!1,removeImage:!1,duplicate:!1,removeBlock:!1,editColor:!1}},y=null,b=0;t.default=(0,u.combineReducers)({setting:r,visibleToolbarButtons:o,grid:i,activeBlock:a})},function(e,t,n){"use strict";function r(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];switch(arguments[1].type){case l.CROPPER_OPEN:return!0;case l.CROPPER_CLOSE:return!1;default:return e}}function o(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:u;switch(arguments[1].type){case l.CROPPER_OPEN:return!0;default:return e}}Object.defineProperty(t,"__esModule",{value:!0});var i=n(3),a=n(1),l=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(a),u={image:null,color:"#fff",imageResize:!1,style:null};t.default=(0,i.combineReducers)({visible:r,setting:o})},function(e,t,n){"use strict";function r(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=arguments[1];switch(t.type){case o.INIT_PLE:return t.value;default:return e}}Object.defineProperty(t,"__esModule",{value:!0});var o=n(1);t.default=r},function(e,t,n){"use strict";function r(e){if(Array.isArray(e)){for(var t=0,n=Array(e.length);t<e.length;t++)n[t]=e[t];return n}return Array.from(e)}function o(e,t,n,r,o){switch(n){case"all":return Object.assign({},e,{active:!0});case"none":return Object.assign({},e,{active:!1});case"cmd":case"ctrl":return e.id===t?Object.assign({},e,{active:!e.active}):e;case"shift":return r=r||0,r<t?e.id>=r&&e.id<=t?Object.assign({},e,{active:!0}):Object.assign({},e,{active:!1}):e.id<=r&&e.id>=t?Object.assign({},e,{active:!0}):Object.assign({},e,{active:!1})}return o>=2&&e.id===t?Object.assign({},e,{active:!0}):e.id===t?Object.assign({},e,{active:!e.active}):Object.assign({},e,{active:!1})}function i(e){return e.map(function(e){if(e.active)return e})}function a(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:f,t=arguments[1];switch(t.type){case s.SIDE_VISIBLE:return u({},e,{visible:t.value});case s.SIDE_TOGGLE:return u({},e,{visible:!e.visible});case s.INIT_PLE:return u({},e,{visible:t.value.preference.side.visible});default:return e}}function l(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments[1];switch(t.type){case s.ADD_FILES:return[].concat(r(e),r(t.files.map(function(e){return{id:d++,image:e,active:!1}})));case s.REMOVE_FILES:if(!t.ids.length)return e;var n=[];return e.forEach(function(e){t.ids.indexOf(e.id)<0&&n.push(e)}),n;case s.CHANGE_ACTIVE_FILE:return e.map(function(n){return o(n,t.num,t.keyName,t.firstNum,i(e).length)});default:return e}}Object.defineProperty(t,"__esModule",{value:!0});var u=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},c=n(3),s=n(1),f={visible:!1},d=0,p=(0,c.combineReducers)({layout:a,files:l});t.default=p},function(e,t){e.exports=ColorPicker},function(e,t){e.exports=ReactGridLayout},function(e,t){e.exports=axios}]);
//# sourceMappingURL=photoLayoutEditor.js.map